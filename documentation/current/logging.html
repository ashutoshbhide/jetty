<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;14.&nbsp;Logging</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><meta name="keywords" content="jetty, servlet-api, cometd, http, spdy, eclipse, maven, java, software"><link rel="home" href="index.html" title="Jetty : The Definitive Reference"><link rel="up" href="advanced.html" title="Part&nbsp;II.&nbsp;Advanced Topics"><link rel="prev" href="advanced-start-matrix.html" title="Start Option Matrix"><link rel="next" href="clients.html" title="Chapter&nbsp;15.&nbsp;Jetty Client Options"><link xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" rel="shortcut icon" href="images/favicon.ico"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><center xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-logo.svg" width="80"></a></center><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;14.&nbsp;Logging</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="advanced-start-matrix.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;II.&nbsp;Advanced Topics</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="clients.html">Next</a></td></tr></table><hr></div><div xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" style="background-color: #DFF2FD; text-align: left; font-size:80%; font-family: arial, sans; border:thin dotted blue; padding: 4px; "><span style="font-variant: small-caps; font-weight: bold"><a href="http://www.webtide.com/support.jsp" style="text-decoration:none">Contact the core Jetty developers at
          <span style="color:#fd360b"> www.webtide.com</span></a></span><br><span style="font-style:oblique;font-size: 80%">
 private support for your internal/customer projects ... custom extensions and distributions ... versioned snapshots for indefinite support ...
 scalability guidance for your apps and Ajax/Comet projects ... development services from 1 day to full product delivery
    </span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="logging"></a>Chapter&nbsp;14.&nbsp;Logging</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="logging.html#d0e6579"></a></span></dt></dl></div><div class="section"><div class="titlepage"></div><div class="toc"><dl><dt><span class="section"><a href="logging.html#d0e6584">Logging with External Frameworks</a></span></dt><dt><span class="section"><a href="logging.html#d0e6665">Sifting Logs with Logback</a></span></dt><dt><span class="section"><a href="logging.html#d0e6707">Logging in Jetty 6</a></span></dt></dl></div><p>Jetty has a builtin logging facade that can log to stderr or to SLF4J (which in turn can log to
    commons-logging, Log4j, NLOG4J or Java logging).</p><p>With any logging framework, all events have a name and a level. The name is a Fully Qualified Class Name
    (FQCN). The logging framework you choose determines the level. While the meaning of the levels is pretty much the
    same across logging frameworks, the descriptive identifiers for those levels are different.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6584"></a>Logging with External Frameworks</h3></div></div></div><p>You can use a logging framework other than the default Jetty Log. You use SLF4J as a fa&#8730;&szlig;ade for
      a logging framework such as logback, java.util.logging, NLOG4J, or Log4j, and all logging events stream to that
      framework. The way you configure the framework determines what you see. If, for example, you want to ignore all
      events below WARN level, or turn on FINE/DEBUG level on org.eclipse.jetty.io.nio?, you can.</p><p>Default Jetty Logging: Jetty 7 and Jetty 8</p><p>The default Jetty log has one name for all logs, using a system property that turns on DEBUG and reports on
      predefined events that write to stderr. You configure logging at startup.</p><p>THIS SHOULD BE A HEAD-&gt;Jetty 7.4.5 and Later</p><p>As of Jetty 7.4.5 Jetty allows for a dynamic level of logging that you set on the command line.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>-Dorg.eclipse.jetty.LEVEL=ERROR&#8218;&Auml;&igrave;Enables a general level of ERROR logging across all
          of jetty</p></li><li class="listitem"><p>-Dorg.eclipse.jetty.sessions.LEVEL=DEBUG&#8218;&Auml;&igrave;Enables a general level of DEBUG logging
          across all logging coming from the sessions packages.</p></li></ul></div><p>THIS SHOULD BE A HEAD-&gt; Jetty 7 Logging Prior to 7.4.5</p><p>Jetty 7 logging prior to 7.4.5 includes some system properties that you can use to control filtering. For
      example, 
      <code class="literal">org.eclipse.jetty.util.log.stderr.DEBUG</code>sets the level filter to DEBUG and higher, with the
      possible levels being IGNORE, DEBUG, INFO, and WARN. By default, Jetty filters from INFO and above, showing only
      INFO and WARN logs. With StdErrLog you always see INFO and WARN logs. You can add DEBUG and/or IGNORE logs. With
      the exception of 
      <code class="literal">org.eclipse.jetty.util.log.class</code>these system properties take boolean values (true or false).
      You set these system properties when you start Jetty.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6614"></a>System Properties for Jetty 7 Logging Prior to 7.4.5</h4></div></div></div><p>The system properties used to enable debugging are:</p><div class="table"><a name="d0e6619"></a><p class="title"><b>Table&nbsp;14.1.&nbsp;Logging System Properties, Jetty 7 Prior to 7.4.5</b></p><div class="table-contents"><table summary="Logging System Properties, Jetty 7 Prior to 7.4.5" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">System Property</th><th align="center">Project</th></tr></thead><tbody><tr><td>org.eclipse.jetty.util.log.class&gt;</td><td>Sets the implementation class for Jetty Logging. Allows you to use an external logging framework
                with Jetty.</td></tr><tr><td>org.eclipse.jetty.util.log.IGNORED</td><td>Shows the IGNORED logging events (ones not deemed pertinent).</td></tr><tr><td>org.eclipse.jetty.util.log.DEBUG (deprecated)</td><td>Shows DEBUG events and up.</td></tr><tr><td>org.eclipse.jetty.util.log.stderr.DEBUG</td><td>Shows DEBUG events and up (for StdErrLog)</td></tr><tr><td>org.eclipse.jetty.util.log.SOURCE (deprecated)</td><td>Shows the output of the log.</td></tr><tr><td>org.eclipse.jetty.util.log.stderr.SOURCE</td><td>Includes the source filename and line number in the StdErrLog output.</td></tr><tr><td>org.eclipse.jetty.util.log.stderr.LONG</td><td>Uses the long form FQCN in the StdErrLog output (defaults to false).</td></tr></tbody></table></div></div><br class="table-break"></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6665"></a>Sifting Logs with Logback</h3></div></div></div><p>This page describes how to create log files at the server level and name them based on an arbitrary context.
  You do this with SLF4J + Logback + Jetty Webapp Logging in the mix. Find example projects for this feature at
  github:</p><p>
    </p><pre class="screen">https://github.com/jetty-project/jetty-and-logback-example</pre><p>
  </p><p></p><div class="table"><a name="d0e6676"></a><p class="title"><b>Table&nbsp;14.2.&nbsp;GitHub Example Project</b></p><div class="table-contents"><table summary="GitHub Example Project" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Modules</th><th align="center">Description</th></tr></thead><tbody><tr><td>/jetty-distro-with-logback-basic/</td><td>Configures the jetty distribution with logback enabled at the server level with an example logback
          configuration.</td></tr><tr><td>/jetty-distro-with-logback-sifting/</td><td>Configures the jetty distribution with logback, centralized webapp logging, an MDC handler, and a
          sample logback configuration that performs sifting based on the incoming Host header on the requests.</td></tr><tr><td>/jetty-slf4j-mdc-handler/</td><td>Provides the SLF4J MDC key/value pairs that Jetty needs to perform the sample sifting.</td></tr><tr><td>/jetty-slf4j-test-webapp/</td><td>A sample webapp+servlet that accepts arbitrary values on a form POST and logs them via SLF4J, so that
          you can see the results of this example.</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6707"></a>Logging in Jetty 6</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6710"></a>Overview</h4></div></div></div><p>Jetty has a builtin logging facade that can log to stderr or to SLF4J (which in turn can log to
    commons-logging, Log4j, NLOG4J or Java logging).</p><p>Jetty logging looks for an SLF4J Jar on the classpath. If present, SLF4J controls logging; otherwise Jetty
    uses stderr. The org.mortbay.log.Log class coordinates logging; By default, Jetty generates only INFO and WARNING
    logs. You can use the following system parameters to control logging: 
    </p><div class="table"><a name="d0e6717"></a><p class="title"><b>Table&nbsp;14.3.&nbsp;Options</b></p><div class="table-contents"><table summary="Options" border="1"><colgroup><col><col></colgroup><tbody><tr><td>org.mortbay.log.class</td><td>Specifies an implementation of org.mortbay.log.Logger to use.</td></tr><tr><td>DEBUG</td><td>If set, DEBUG logs are produced, else Jetty generates only INFO and WARN logs.</td></tr><tr><td>VERBOSE</td><td>If set, VERBOSE logging is produced, including IGNORED exceptions.</td></tr><tr><td>IGNORED</td><td>If set (jetty 6.1.10 and later), IGNORED exceptions are logged independent of DEBUG and VERBOSE
            settings.</td></tr></tbody></table></div></div><p><br class="table-break"></p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6742"></a>Logging for Jetty Standalone</h4></div></div></div><p>The core of Jetty has no hard dependencies on an external logging infrastructure.</p><p>The only logging dependency is introduced by Jasper, the JSP engine. Jasper has traditionally had a
    dependency on commons-logging, which proves problematic in container-based architectures. To overcome this, Jetty
    uses two different solutions, depending on the version of JSP standard.</p><p><span class="emphasis"><em>Note:</em></span> The start.jar mechanism automatically selects a JSP version at runtime based on
    the JDK version. As JSP 2.1 mandates at least JDK 1.5, if you are running with a 1.5 JVM this is the version
    selected. However, if you are running with a lower version JVM, the 
    <code class="literal">start.jar</code>mechanism places the JSP 2.0 Jars onto the classpath.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6756"></a>JSP 2.0</h4></div></div></div><p>Jetty uses the SLF4J logging infrastructure to bridge to commons-logging for JSP2.0. This means that Jetty
    sends commons-log messages to the SLF4J interface.</p><p>Jetty ships with the Simple log impl, which outputs only INFO level and above messages to stderr. You can
    replace the Simple log with any other SLF4J log impl by removing the 
    <code class="literal">lib/jsp-2.0/slf4j-simple-1.0-rc5.jar</code>and copying in the SLF4J impl of your choice. The core Jetty
    code has a soft dependency on SLF4J, meaning that if an SLF4J impl is on the classpath at startup, Jetty directs
    all logging messages to it.</p><p>Alternatively, you can remove the SLF4J Jars and use commons-logging instead by copying in the
    commons-logging Jar and a commons-logging compliant log impl, such as Log4j, to the 
    <code class="literal">lib/</code>directory. If you do that, be aware that the core Jetty code does not use commons-logging;
    it logs messages to stderr instead. Read on to learn how to get the stderr log mechanism to print DEBUG level
    messages.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6771"></a>JSP 2.1</h4></div></div></div><p>With the 2.1 version of the JSP specification, Jetty has removed all logging dependencies from the Jasper
    code. This means that you don't need an external logger&#8218;&Auml;&icirc;Jetty uses its own stderr logging
    mechanism. By default, that outputs only INFO level and above messages.</p><p>To enable logging of DEBUG level messages, invoke Jetty with the -DDEBUG flag:</p><p>
      </p><pre class="screen">java -DDEBUG -jar start.jar</pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6783"></a>Logging for Jetty Embedded</h4></div></div></div><p>Since the core of Jetty has no hard external logging dependency, if you include only the 
    <code class="literal">lib/jetty-util.jar</code>and 
    <code class="literal">lib/jetty.jar</code>on your classpath, Jetty directs all log messages to stderr. To see DEBUG level
    messages, start your application with the -DDEBUG flag:</p><p>
      </p><pre class="screen">java -DDEBUG ......</pre><p>
    </p><p>Alternatively, call SystemProperty.set("DEBUG", "true") before calling new 
    <code class="literal">org.mortbay.jetty.Server()</code>. If your embedded application includes the Jars from either of the
    JSP versions in 
    <code class="literal">lib/</code>, then read the previous section for instructions on how to configure logging.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6807"></a>Logging with the maven-jetty-plugin</h4></div></div></div><p>As with all Maven plugins, log messages produced by the plugin itself are sent to stderr and only at the INFO
    level and above. To see DEBUG level messages from the plugin, invoke the plugin with the -X flag:</p><p>
      </p><pre class="screen">mvn -X jetty:run</pre><p>
    </p><p>Log messages from the Jetty instance embedded in the plugin work in much the same way as Jetty standalone.
    The plugin picks an appropriate JSP version based on the version of the JVM executing the plugin. See the Jetty
    Maven2 Plugin pages for an explanation of how to configure logging.</p></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="advanced-start-matrix.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="advanced.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="clients.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Start Option Matrix&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;15.&nbsp;Jetty Client Options</td></tr></table></div><div xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" style="background-color: #DFF2FD; text-align: left; font-size:80%; font-family: arial, sans; border:thin dotted blue; padding: 4px; "><span style="font-style:oblique;font-size: 80%">
See an error or something missing?<br></span><span style="font-variant: small-caps; font-weight: bold"><a href="http://github.com/jetty-project/jetty-documentation" style="text-decoration:none">Contribute to this documentation at 
          <span style="color:#fd360b"> Github!</span></a></span><br></div></body></html>