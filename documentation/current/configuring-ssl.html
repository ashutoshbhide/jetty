<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Configuring SSL</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><style type="text/css">
body { background-image: url('images/draft-ribbon.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><meta name="keywords" content="jetty, servlet-api, cometd, http, spdy, eclipse, maven, java, software"><link rel="home" href="index.html" title="Jetty : The Definitive Reference"><link rel="up" href="configuring-connectors.html" title="Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors"><link rel="prev" href="configuring-connectors.html" title="Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors"><link rel="next" href="setting-port80-access.html" title="Setting Port 80 Access for a Non-Root User"><link xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" rel="shortcut icon" href="images/favicon.ico"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><center xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-logo.svg" width="80"></a></center><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Configuring SSL</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configuring-connectors.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="setting-port80-access.html">Next</a></td></tr></table><hr></div><div xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" style="background-color: #DFF2FD; text-align: left; font-size:80%; font-family: arial, sans; border:thin dotted blue; padding: 4px; "><span style="font-variant: small-caps; font-weight: bold"><a href="http://www.webtide.com/support.jsp" style="text-decoration:none">Contact the core Jetty developers at
          <span style="color:#fd360b"> www.webtide.com</span></a></span><br><span style="font-style:oblique;font-size: 80%">
 private support for your internal/customer projects ... custom extensions and distributions ... versioned snapshots for indefinite support ...
 scalability guidance for your apps and Ajax/Comet projects ... development services from 1 day to full product delivery
    </span></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuring-ssl"></a>Configuring SSL</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="configuring-ssl.html#understanding-certificates-and-keys">Understanding Certificates and Keys</a></span></dt></dl></div><p>This document provides an overview of how to configure SSL (aka TLS) for Jetty, which uses Sun's reference
  implementation for the Java Secure Sockets Extension (JSSE).</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="understanding-certificates-and-keys"></a>Understanding Certificates and Keys</h3></div></div></div><p>Configuring SSL can be a confusing experience of keys, certificates, protocols and formats, thus it helps to
    have a reasonable understanding of the basics. The following links provide some good starting points:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Certificates: 
      <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><a class="link" href="http://en.tldp.org/HOWTO/SSL Certificates HOWTO" target="_top">SSL Certificates HOWTO</a></li><li class="listitem"><a class="link" href="http://mindprod.com/jgloss/certificate.html" target="_top">Mindprod Java Glossary: Certificates</a></li></ul></div></li><li class="listitem">Keytool: 
      <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><a class="link" href="http://docs.oracle.com/javase/1.4.2/docs/tooldocs/solaris/keytool.html" target="_top">Keytool for
          Unix</a></li><li class="listitem"><a class="link" href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/keytool.html" target="_top">Keytool for
          Windows</a></li></ul></div></li><li class="listitem">Other tools: 
      <div class="itemizedlist"><a class="link" href="https://www.ibm.com/developerworks/mydeveloperworks/groups/service/html/communityview?communityUuid=6fb00498-f6ea-4f65-bf0c-adc5bd0c5fcc" target="_top">IBM
        Keyman</a><ul class="itemizedlist" type="circle"></ul></div></li><li class="listitem">OpenSSL: 
      <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><a class="link" href="http://www.openssl.org/docs/HOWTO/" target="_top">OpenSSL HOWTO</a></li><li class="listitem"><a class="link" href="http://www.openssl.org/support/faq.html" target="_top">OpenSSL FAQ</a></li></ul></div></li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="openssl-vs-keytool"></a>OpenSSL vs. Keytool</h4></div></div></div><p>For testing, Keytool probably provides the simplest way to generate the key and certificate you
      need.</p><p>You can also use the OpenSSL tools to generate keys and certificates, or to convert those that you have
      used with Apache or other servers. Since Apache and other servers commonly use the OpenSSL tool suite to generate
      and manipulate keys and certificates, you might already have some keys and certificates created by OpenSSL. Also,
      OpenSSL might be more trusted than Keytool or some certificate authorities. You might also prefer the formats
      OpenSSL produces.</p><p>If you want the option of using the same certificate with Jetty or a web server such as Apache not written
      in Java, you might prefer to generate your private key and certificate with OpenSSL. The Java Keytool does not
      provide options for exporting private keys, and Apache needs the private key. If you create the key and
      certificate with OpenSSL, your non-Java web server has ready access to it.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="configuring-jetty-for-ssl"></a>Configuring Jetty for SSL</h4></div></div></div><p>To configure Jetty for SSL, complete the tasks in the following sections:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="xref" href="configuring-ssl.html#generating-key-pairs-and-certificates" title="Generating Key Pairs and Certificates">Generating Key Pairs and Certificates</a></li><li class="listitem"><a class="xref" href="configuring-ssl.html#requesting-trusted-certificate" title="Requesting a Trusted Certificate">Requesting a Trusted Certificate</a></li><li class="listitem"><a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">Loading Keys and Certificates</a></li><li class="listitem"><a class="xref" href="configuring-ssl.html#configuring-ssl-parameters" title="Configuring SSL Keystore">Configuring SSL Keystore</a></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="generating-key-pairs-and-certificates"></a>Generating Key Pairs and Certificates</h4></div></div></div><p>The simplest way to generate keys and certificates is to use the Keytool application that comes with the
      JDK, as it generates keys and certificates directly into the keystore. See <a class="xref" href="configuring-ssl.html#generating-key-pairs-and-certificates-JDK-keytool" title="Generating Keys and Certificates with JDK Keytool">Generating Keys and Certificates with JDK Keytool</a>.</p><p>If you already have keys and certificates, see <a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">Loading Keys and Certificates</a> to load
      them into a JSSE key store. This section also applies if you have a renewal certificate to replace one that is
      expiring.</p><p>The examples below generate only basic keys and certificates. You should read the full manuals of the tools
      you are using if you want to specify:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Key size.</li><li class="listitem">Certificate expiry.</li><li class="listitem">Alternate security providers.</li></ul></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-key-pairs-and-certificates-JDK-keytool"></a>Generating Keys and Certificates with JDK Keytool</h5></div></div></div><p>The following command generates a key pair and certificate directly into a keystore:</p><pre class="screen">
&gt; keytool -keystore keystore -alias jetty -genkey -keyalg RSA
        </pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>The DSA key algorithm certificate produces an error after loading several pages. In a browser, it
        displays a message "Could not establish an encrypted connection because certificate presented by localhost has
        an invalid signature." The solution is to use RSA for the key algorithm.</div><p>This command prompts for information about the certificate and for passwords to protect both the keystore
        and the keys within it. The only mandatory response is to provide the fully qualified host name of the server
        at the "first and last name" prompt. For example:</p><pre class="screen">
&gt; keytool -keystore keystore -alias jetty -genkey -keyalg RSA
 Enter keystore password:  password
 What is your first and last name?
   [Unknown]:  jetty.eclipse.org
 What is the name of your organizational unit?
   [Unknown]:  Jetty
 What is the name of your organization?
   [Unknown]:  Mort Bay Consulting Pty. Ltd.
 What is the name of your City or Locality?
   [Unknown]:
 What is the name of your State or Province?
   [Unknown]:
 What is the two-letter country code for this unit?
   [Unknown]:
 Is CN=jetty.eclipse.org, OU=Jetty, O=Mort Bay Consulting Pty. Ltd.,
 L=Unknown, ST=Unknown, C=Unknown correct?
   [no]:  yes
 
 Enter key password for &lt;jetty&gt;
         (RETURN if same as keystore password):  password
        </pre><p>You now have the minimal requirements to run an SSL connection and could proceed directly to 
            License Details
         to configure an SSL connector. However the browser will not trust the
        certificate you have generated, and prompts the user to this effect. While what you have at this point is often
        sufficient for testing, most public sites need a trusted certificate, as shown in the section, <a class="xref" href="configuring-ssl.html#generating-csr-from-keytool" title="Generating a CSR from Keytool">Generating a CSR from Keytool</a>.</p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-keys-and-certificates-openssl"></a>Generating Keys and Certificates with OpenSSL</h5></div></div></div><p>The following command generates a key pair in the file <code class="filename">jetty.key</code>:</p><pre class="screen">
&gt; openssl genrsa -des3 -out jetty.key
        </pre><p>You might also want to use the <code class="filename">-rand</code> file argument to provide an arbitrary file that
        helps seed the random number generator.</p><p>The following command generates a certificate for the key into the file <code class="filename">
        jetty.crt</code>:</p><pre class="screen">
&gt; openssl req -new -x509 -key jetty.key -out jetty.crt
        </pre><p>The next command prompts for information about the certificate and for passwords to protect both the
        keystore and the keys within it. The only mandatory response is to provide the fully qualified host name of the
        server at the ''Common Name'' prompt. For example:</p><pre class="screen">
&gt; openssl genrsa -des3 -out jetty.key
 Generating RSA private key, 512 bit long modulus
 ...........................++++++++++++
 ..++++++++++++
 e is 65537 (0x10001)
 Enter pass phrase for jetty.key:
 Verifying - Enter pass phrase for jetty.key:
 
&gt; openssl req -new -x509 -key jetty.key -out jetty.crt
 Enter pass phrase for jetty.key:
 You are about to be asked to enter information to be incorporated
 into your certificate request.
 What you are about to enter is what is called a Distinguished Name or a DN.
 There are quite a few fields but you can leave some blank
 For some fields there is a default value,
 If you enter '.', the field is left blank.
 -----
 Country Name (2 letter code) [AU]:.
 State or Province Name (full name) [Some-State]:.
 Locality Name (eg, city) []:.
 Organization Name (eg, company) [Internet Widgets Pty Ltd]:Mort Bay Consulting Pty. Ltd.
 Organizational Unit Name (eg, section) []:Jetty
 Common Name (eg, YOUR name) []:jetty.eclipse.org
 Email Address []:

&gt;
        </pre><p>You now have the minimal requirements to run an SSL connection and could proceed directly to <a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">Loading Keys and Certificates</a> to load these keys and certificates into a JSSE keystore. However
        the browser will not trust the certificate you have generated, and prompts the user to this effect. While what
        you have at this point is often sufficient for testing, most public sites need a trusted certificate, as shown
        in the section, <a class="xref" href="configuring-ssl.html#generating-csr-from-openssl" title="Generating a CSR from OpenSSL">Generating a CSR from OpenSSL</a> to obtain a certificate.</p></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="using-keys-and-certificates-from-other-sources"></a>Using Keys and Certificates from Other Sources</h5></div></div></div><p>If you have keys and certificates from other sources, you can proceed directly to <a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">Loading Keys and Certificates</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="requesting-trusted-certificate"></a>Requesting a Trusted Certificate</h4></div></div></div><p>The keys and certificates generated with the JDK Keytool and OpenSSL are sufficient to run an SSL
      connector. However the browser will not trust the certificate you have generated, and it will prompt the user to
      this effect.</p><p>To obtain a certificate that most common browsers will trust, you need to request a well-known certificate
      authority (CA) to sign your key/certificate. Such trusted CAs include: AddTrust, Entrust, GeoTrust, RSA Data
      Security, Thawte, VISA, ValiCert, Verisign, and beTRUSTed, among others. Each CA has its own instructions (look
      for JSSE or OpenSSL sections), but all involve a step that generates a certificate signing request (CSR).</p><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-csr-from-keytool"></a>Generating a CSR from Keytool</h5></div></div></div><p>The following command generates the file <code class="filename">jetty.csr</code> using Keytool for a key/cert
        already in the keystore:</p><pre class="screen">
&gt; keytool -certreq -alias jetty -keystore keystore -file jetty.csr
        </pre></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="generating-csr-from-openssl"></a>Generating a CSR from OpenSSL</h5></div></div></div><p>The following command generates the file <code class="filename">jetty.csr</code> using OpenSSL for a key in the
        file <code class="filename">jetty.key</code>:</p><pre class="screen">
&gt; openssl req -new -key jetty.key -out jetty.csr
        </pre><p>Notice that this command uses only the existing key from <code class="filename">jetty.keyfile</code>, and not a
        certificate in <code class="filename">jetty.crt</code> as generated with OpenSSL. You need to enter the details for the
        certificate again.</p></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="loading-keys-and-certificates"></a>Loading Keys and Certificates</h4></div></div></div><p>Once a CA has sent you a certificate, or if you generated your own certificate without Keytool, you need to
      load it into a JSSE keystore.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>You need both the private key and the certificate in the keystore. You should load the certificate into the
      keystore used to generate the CSR with Keytool. If your key pair is not in a keystore (generated with OpenSSL),
      you need to use the PKCS12 format to load both key and certificate (see <a class="xref" href="configuring-ssl.html#loading-keys-and-certificates-via-pkcks12" title="Loading Keys and Certificates via PKCS12">Loading Keys and Certificates via PKCS12</a>.</div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="loading-certificates-with-keytool"></a>Loading Certificates with Keytool</h5></div></div></div><p>You can use Keytool to load a certificate in PEM form directly into a keystore. The PEM format is a text
        encoding of certificates; it is produced by OpenSSL, and is returned by some CAs. An example PEM file
        is:</p><pre class="screen">
jetty.crt 
-----BEGIN CERTIFICATE----- 
MIICSDCCAfKgAwIBAgIBADANBgkqhkiG9w0BAQQFADBUMSYwJAYDVQQKEx1Nb3J0
IEJheSBDb25zdWx0aW5nIFB0eS4gTHRkLjEOMAwGA1UECxMFSmV0dHkxGjAYBgNV
BAMTEWpldHR5Lm1vcnRiYXkub3JnMB4XDTAzMDQwNjEzMTk1MFoXDTAzMDUwNjEz
MTk1MFowVDEmMCQGA1UEChMdTW9ydCBCYXkgQ29uc3VsdGluZyBQdHkuIEx0ZC4x
DjAMBgNVBAsTBUpldHR5MRowGAYDVQQDExFqZXR0eS5tb3J0YmF5Lm9yZzBcMA0G
CSqGSIb3DQEBAQUAA0sAMEgCQQC5V4oZeVdhdhHqa9L2/ZnKySPWUqqy81riNfAJ
7uALW0kEv/LtlG34dOOcVVt/PK8/bU4dlolnJx1SpiMZbKsFAgMBAAGjga4wgasw
HQYDVR0OBBYEFFV1gbB1XRvUx1UofmifQJS/MCYwMHwGA1UdIwR1MHOAFFV1gbB1
XRvUx1UofmifQJS/MCYwoVikVjBUMSYwJAYDVQQKEx1Nb3J0IEJheSBDb25zdWx0
aW5nIFB0eS4gTHRkLjEOMAwGA1UECxMFSmV0dHkxGjAYBgNVBAMTEWpldHR5Lm1v
cnRiYXkub3JnggEAMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEEBQADQQA6NkaV
OtXzP4ayzBcgK/qSCmF44jdcARmrXhiXUcXzjxsLjSJeYPJojhUdC2LQKy+p4ki8
Rcz6oCRvCGCe5kDB 
-----END CERTIFICATE-----
        </pre><p>The following command loads a PEM encoded certificate in the <code class="filename">jetty.crt</code> file into a
        JSSE keystore:</p><pre class="screen">
&gt; keytool -keystore keystore -import -alias jetty -file jetty.crt -trustcacerts
        </pre><p>Depending on the situation, you might not require the <code class="code">-trustcacerts</code> option. Try the
        operation without it if you like. If the certificate you receive from the CA is not in a format that Keytool
        understands, you can use the <code class="code">openssl</code> command to convert formats:</p><pre class="screen">
&gt; openssl x509 -in jetty.der -inform DER -outform PEM -out jetty.crt
        </pre></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="loading-keys-and-certificates-via-pkcks12"></a>Loading Keys and Certificates via PKCS12</h5></div></div></div><p>If you have a key and certificate in separate files, you need to combine them into a PKCS12 format file
        to load into a new keystore. The certificate can be one you generated yourself or one returned from a CA in
        response to your CSR.</p><p>The following OpenSSL command combines the keys in <code class="filename">jetty.key</code> and the certificate in
        the <code class="filename">jetty.crt</code> file into the <code class="filename">jetty.pkcs12</code> file:</p><pre class="screen">
&gt; openssl pkcs12 -inkey jetty.key -in jetty.crt -export -out jetty.pkcs12
        </pre><p>If you have a chain of certificates, because your CA is an intermediary, build the PKCS12 file as
        follows:</p><pre class="screen">
&gt; cat example.crt intermediate.crt [intermediate2.crt]... rootCA.crt &gt; cert-chain.txt 
&gt; openssl pkcs12 -export -inkey example.key -in cert-chain.txt -out example.pkcs12
        </pre><p>The order of certificates must be from server to rootCA, as per RFC2246 section 7.4.2.</p><p>OpenSSL asks for an <span class="emphasis"><em>export password</em></span>. A non-empty password seems to be required to
        make the next step work. Then load the resulting PKCS12 file into a JSSE keystore with the following jetty
        utility class:</p><div class="informalexample"><pre class="programlisting">
&gt; java -classpath $JETTY_HOME/lib/jetty-util-<span class="hl-number">6.1</span>-SNAPSHOT.jar:$JETTY_HOME/lib/jetty-<span class="hl-number">6.1</span>-SNAPSHOT.jar org.eclipse.jetty.security.PKCS12Import jetty.pkcs1<span class="hl-number">2</span> keystore        
          </pre></div><p>This asks for two passphrases. Give the password from the last step as the input passphrase and you are
        set. The "output passphrase" must appear in your <code class="filename">jetty.xml</code> config file as both the
        Password and KeyPassword of the SunJsseListener that uses the certificate.</p><p>You can also use Keytool (starting form jdk1.6) to import a PKCS12 file with the following
        command:</p><pre class="screen">
&gt; keytool -importkeystore -srckeystore jetty.pkcs12 -srcstoretype PKCS12 -destkeystore keystore
        </pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="configuring-ssl-parameters"></a>Configuring SSL Keystore</h4></div></div></div><p>The generated SSL certificates held in the key store are configured on Jetty by injection an instance of
      <a class="link" href="http://download.eclipse.org/jetty/stable-9/apidocs/org/eclipse/jetty/util/ssl/SslContextFactory.html" target="_top">
      SslContextFactory</a> object and passing it to the connector's SslConnectionFactory, which is done in the
      jetty distribution by both in <a class="link" href="http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/plain/jetty-server/src/main/config/etc/jetty-https.xml" target="_top">jetty-https.xml</a> and
      <a class="link" href="http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/plain/jetty-spdy/spdy-example-webapp/src/main/config/etc/jetty-spdy.xml" target="_top">jetty-spdy.xml</a>.
      Since SPDY is able to handle HTTPS also, typically you will configure jetty to use one of these configuration
      files or the other, which can be done other on the command line or by editing the start.ini file.</p><p>These configuration files create an SslContextFactory instance with the ID "sslContextFactory":</p><div class="informalexample"><pre class="programlisting">

  <strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"sslContextFactory"</span> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.util.ssl.SslContextFactory"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"KeyStorePath"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"jetty.home"</span> <span class="hl-attribute" style="color: #F5844C">default</span>=<span class="hl-value" style="color: #993300">"."</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>/etc/keystore<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"KeyStorePassword"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"KeyManagerPassword"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>OBF:1u2u1wml1z7s1z7a1wnl1u2g<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"TrustStorePath"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"jetty.home"</span> <span class="hl-attribute" style="color: #F5844C">default</span>=<span class="hl-value" style="color: #993300">"."</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>/etc/keystore<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"TrustStorePassword"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
        
        </pre></div><p>This example uses the keystore distributed with jetty. To use your own keystore you need to update at least
      the following settings:</p><div class="variablelist"><dl><dt><span class="term">KeyStorePath</span></dt><dd><p>You can either replace the provided keystore with your own, or change the configuration to point to a
            different file. Note that as a keystore is vital security information, it can be desirable to locate the
            file in a directory with very restricted access.</p></dd><dt><span class="term">KeyStorePassword</span></dt><dd><p>The keystore password may be set here in plain text, or as some protection from casual observation,
            it may be obfuscated using the <a class="link" href="http://download.eclipse.org/jetty/stable-9/apidocs/org/eclipse/jetty/util/security/Password.html" target="_top">
            Password</a> class.</p></dd></dl></div><p>The Truststore is used if validating client certificates and is typically set to the same keystore.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="configuring-ssl-for-earlier-versions-of-jetty"></a>Configuring SSL Connector and Port</h4></div></div></div><p>This SslContextFactory instance created above is injected into a SslConnectionFactory instance to be used
      when accepting network connections, which in turn is injected into an Instance of ServerConnector. For example
      from <a class="link" href="http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/plain/jetty-server/src/main/config/etc/jetty-https.xml" target="_top">jetty-https.xml</a>:</p><div class="informalexample"><pre class="programlisting">

  <strong class="hl-tag" style="color: #000096">&lt;Call</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"sslConnector"</span> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"addConnector"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Arg&gt;</strong>
      <strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.ServerConnector"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
        <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"server"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Ref</strong> <span class="hl-attribute" style="color: #F5844C">refid</span>=<span class="hl-value" style="color: #993300">"Server"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
          <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"factories"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
            <strong class="hl-tag" style="color: #000096">&lt;Array</strong> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.ConnectionFactory"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
              <strong class="hl-tag" style="color: #000096">&lt;Item&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.SslConnectionFactory"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
                  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"next"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>http/1.1<strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
                  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"sslContextFactory"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Ref</strong> <span class="hl-attribute" style="color: #F5844C">refid</span>=<span class="hl-value" style="color: #993300">"sslContextFactory"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
              <strong class="hl-tag" style="color: #000096">&lt;/Item&gt;</strong>
              <strong class="hl-tag" style="color: #000096">&lt;Item&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.HttpConnectionFactory"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
                  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"config"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Ref</strong> <span class="hl-attribute" style="color: #F5844C">refid</span>=<span class="hl-value" style="color: #993300">"tlsHttpConfig"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
                <strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
              <strong class="hl-tag" style="color: #000096">&lt;/Item&gt;</strong>
            <strong class="hl-tag" style="color: #000096">&lt;/Array&gt;</strong>
          <strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
          <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"host"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"jetty.host"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
          <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"port"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"jetty.tls.port"</span> <span class="hl-attribute" style="color: #F5844C">default</span>=<span class="hl-value" style="color: #993300">"8443"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
          <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"idleTimeout"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>30000<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
        <strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;/Call&gt;</strong>
        
        </pre></div><p>Note also that the SSL connectors port is set directly on the ServerConnector instance.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="renewing-certificates"></a>Renewing Certificates</h4></div></div></div><p>If you are updating your configuration to use a newer certificate, as when the old one is expiring, just
      load the newer certificate as described in the section, <a class="xref" href="configuring-ssl.html#loading-keys-and-certificates" title="Loading Keys and Certificates">Loading Keys and Certificates</a>. If you
      imported the key and certificate originally using the PKCS12 method, use an alias of "1" rather than "jetty",
      because that is the alias the PKCS12 process enters into the keystore.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configuring-connectors.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="configuring-connectors.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="setting-port80-access.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Setting Port 80 Access for a Non-Root User</td></tr></table></div><div xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" style="background-color: #DFF2FD; text-align: left; font-size:80%; font-family: arial, sans; border:thin dotted blue; padding: 4px; "><span style="font-style:oblique;font-size: 80%">
See an error or something missing?<br></span><span style="font-variant: small-caps; font-weight: bold"><a href="http://github.com/jetty-project/jetty-documentation" style="text-decoration:none">Contribute to this documentation at
          <span style="color:#fd360b"> Github!</span></a></span><br></div><script xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1149868-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script></body></html>