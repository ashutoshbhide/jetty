<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;10.&nbsp;Starting Jetty</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><meta name="keywords" content="jetty, servlet, servlet-api, cometd, http, spdy, websocket, eclipse, maven, java, server, software"><link rel="home" href="index.html" title="Jetty : The Definitive Reference"><link rel="up" href="administration.html" title="Part&nbsp;III.&nbsp;Jetty Administration Guide"><link rel="prev" href="administration.html" title="Part&nbsp;III.&nbsp;Jetty Administration Guide"><link rel="next" href="startup-xml-config.html" title="Managing XML Based Startup Configuration"><link xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" rel="shortcut icon" href="images/favicon.ico"><script type="text/javascript" src="js/shCore.js"></script><script type="text/javascript" src="js/shBrushJava.js"></script><script type="text/javascript" src="js/shBrushXml.js"></script><script type="text/javascript" src="js/shBrushBash.js"></script><script type="text/javascript" src="js/shBrushJScript.js"></script><script type="text/javascript" src="js/shBrushSql.js"></script><script type="text/javascript" src="js/shBrushProperties.js"></script><script type="text/javascript" src="js/shBrushPlain.js"></script><link type="text/css" rel="stylesheet" href="css/shCore.css"><link type="text/css" rel="stylesheet" href="css/shThemeEclipse.css"><link type="text/css" rel="stylesheet" href="css/font-awesome.min.css"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><tr><td style="width: 25%"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-header-logo.png" alt="Jetty Logo"></a><br><span style="font-size: small">
            Version: 9.1.0-SNAPSHOT</span></td><td style="width: 50%"><script type="text/javascript">  (function() {
            var cx = '016459005284625897022:obd4lsai2ds';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
            })();
          </script><gcse:search></gcse:search></td></tr></table><div xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;10.&nbsp;Starting Jetty</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="administration.html"><i class="icon-chevron-left"></i> Previous</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;III.&nbsp;Jetty Administration Guide<br><a accesskey="p" href="index.html"><i class="icon-home"></i> Home</a></th><td width="20%" align="right">&nbsp;<a accesskey="n" href="startup-xml-config.html">Next <i class="icon-chevron-right"></i></a></td></tr></table><hr></div><div xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" class="jetty-callout"><h5 class="callout"><a href="http://www.webtide.com/">Contact the core Jetty developers at
          <span class="website">www.webtide.com</span></a></h5><p>
 private support for your internal/customer projects ... custom extensions and distributions ... versioned snapshots for indefinite support ...
 scalability guidance for your apps and Ajax/Comet projects ... development services from 1 day to full product delivery
      </p></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="startup"></a>Chapter&nbsp;10.&nbsp;Starting Jetty</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="startup.html#startup-overview">Startup Overview</a></span></dt><dt><span class="section"><a href="startup-xml-config.html">Managing XML Based Startup Configuration</a></span></dt><dt><span class="section"><a href="startup-classpath.html">Managing Server Classpath</a></span></dt><dt><span class="section"><a href="startup-modules.html">Managing Startup Modules</a></span></dt><dt><span class="section"><a href="startup-base-and-home.html">Managing Jetty Base and Jetty Home</a></span></dt><dt><span class="section"><a href="start-jar.html">Using start.jar</a></span></dt><dt><span class="section"><a href="startup-troubleshooting.html">Startup Troubleshooting</a></span></dt><dt><span class="section"><a href="start-jetty-sh.html">Startup via jetty.sh</a></span></dt><dt><span class="section"><a href="startup-unix-service.html">Startup via Unix Service</a></span></dt><dt><span class="section"><a href="startup-windows-service.html">Startup via Windows Service</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="startup-overview"></a>Startup Overview</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="startup.html#d0e7792">Startup Example</a></span></dt></dl></div><p>The startup of standalone Jetty is managed by the start.jar bootstrap,
  which is responsible for:</p><div class="variablelist"><dl><dt><span class="term">Building the classpath</span></dt><dd><p>The start.jar bootstrap will build a classpath for all the
        required jetty features and their dependencies. The classpath is built
        using either the --lib option to start.jar to add an individual
        classpath entry, or with the --module option that will include all the
        libs and their dependencies for a module (a named jetty feature).
        </p></dd><dt><span class="term">Instantiating the Server Components</span></dt><dd><p>The server and it's components are instantiated using either
        Jetty IoC XML or spring. The Jetty server is just a collection of java
        POJOs for the server, connectors, session managers etc. These are
        instantiated, injected and wired up together in XML files, commonly
        one per module/feature, that are passed as arguments to start.jar
        </p></dd><dt><span class="term">Resolve locations</span></dt><dd><p>The start.jar mechanism will resolve canonical locations for the
        Jetty home directory and the jetty base directory. The jetty home is
        the location of the standard distribution of jetty and the jetty base
        is the location of the local server customization and configurations.
        If the jetty distribution is to be modified then the base and home can
        be the same directory. Having the base in a different directory allows
        the distribution to remain unmodified and thus simplifies subsequent
        server version upgrades. </p></dd><dt><span class="term">Parameterize the Server Configuration</span></dt><dd><p>The server configuration is primarily determined by the XML
        files, however many of these files are parameterized to allow simple
        injection of host names, ports, passwords etc. The start.jar mechanism
        allows parameters to be set on the command line or in properties
        files.</p></dd><dt><span class="term">Discover and deploy standard web applications</span></dt><dd><p>If a deployer component is configured, then standard bases web
        applications will be discovered and individual contexts instantiated,
        configured and deployed.I</p></dd></dl></div><p>In order to achieve these start up mechanism, the start.jar
  uses:</p><div class="variablelist"><dl><dt><span class="term">Command line arguments</span></dt><dd><p>The entire server may be configured with command line arguments
        that specify libraries, properties and XML files. However in practise
        the ini and modules mechanisms (below) are used to reduce the
        verbosity of the command line.</p></dd><dt><span class="term">Ini files</span></dt><dd><p>The contents of the $JETTY_BASE/start.ini and
        $JETTY_BASE/start.d/*.ini files are used by start.jar as each line
        being equivalent to a start.jar command line arguments. This allows
        the configuration of the server to be controlled by either a global
        start.ini file or by multiple start.d/feature.ini files.</p></dd><dt><span class="term">Modules</span></dt><dd><p>Instead of explicitly listing all the libraries, properties and
        XML files for a feature, the start.jar mechanism allows for the
        creation of modules. A module is defined in a modules/*.mod file and
        includes the libraries, dependencies, XML and template ini files for a
        jetty feature. Thus a single --module=name command line option can be
        used as the equivalent of specifying many --lib=location, feature.xml,
        name=value arguments for a feature and all its dependencies. Modules
        also use their dependencies to control the ordering of libraries and
        XML files. </p></dd><dt><span class="term">XML Files</span></dt><dd><p>The actual POJO components of the server are instantiated and
        injected by XML files in either jetty IoC or spring format. All major
        components such as connectors, keystores, session managers, data
        sources are instantiated in XML files. Typically there are one or more
        XML file per module and these are defined and activated in the
        corresponding module.</p></dd></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7792"></a>Startup Example</h3></div></div></div><p>The core jetty server can be started in an empty directory with the
    following verbose commands:</p><div class="screenexample"><pre class="screen">&gt; echo jetty.port:8080 &gt; /tmp/jetty.properties
&gt; java -Djetty.home=$JETTY_HOME -Djetty.base=$PWD -cp\
 $JETTY_HOME/lib/jetty-util-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/jetty-xml-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/jetty-io-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/jetty-http-$JETTY_VERSION.jar\
:$JETTY_HOME/lib/servlet-api-3.1.jar\
:$JETTY_HOME/lib/jetty-server-$JETTY_VERSION.jar \
org.eclipse.jetty.xml.XmlConfiguration \
/tmp/jetty.properties \
$JETTY_HOME/etc/jetty.xml \
$JETTY_HOME/etc/jetty-http.xml
</pre></div><p>The java command sets up the classpath with the core jetty jars and
    the servlet API, executes the XmlConfiguration class and passes it some
    XML files that define the server and a HTTP connector running on the port
    defined in the jetty.properties file.</p><p>Exactly the same can be achieve with the jetty start.jar mechanism
    using the following java command line:</p><div class="screenexample"><pre class="screen">&gt; java -jar $JETTY_HOME/start.jar --module=http jetty.port=8080</pre></div><p>This command uses the start.jar mechanism to boot strap the
    classpath, properties and XML files with the metadata obtained from the
    <code class="literal">http</code> module. Specifically the <code class="literal">http</code>
    module is defined in the <code class="filename">$JETTY_HOME/modules/http.mod</code>
    file and includes the following:</p><div class="screenexample"><pre class="screen">&gt; cat $JETTY_HOME/modules/http.mod
[depend]
server

[xml]
etc/jetty-http.xml

[ini-template]
jetty.port=8080
http.timeout=30000</pre></div><p>The <code class="literal">http</code> module declares that
    <code class="literal">http</code> depends on the server module, uses the
    <code class="filename">jetty-http.xml</code> file and can be parameterised with
    <code class="literal">jetty.port</code> and <code class="literal">http.timeout</code>
    parameters. The ini-template section is not actually used by the command
    above, so the <code class="literal">jetty.port</code> must still be defined on the
    command line.</p><p>Following the server dependency, the
    <code class="filename">$JETTY_HOME/modules/server.mod</code> file includes:</p><div class="screenexample"><pre class="screen">&gt; cat $JETTY_HOME/modules/server.mod
[lib]
lib/servlet-api-3.1.jar
lib/jetty-http-${jetty.version}.jar
lib/jetty-server-${jetty.version}.jar
lib/jetty-xml-${jetty.version}.jar
lib/jetty-util-${jetty.version}.jar
lib/jetty-io-${jetty.version}.jar

[xml]
etc/jetty.xml

[ini-template]
threads.min=10
threads.max=200
</pre></div><p>The <code class="literal">server</code> module declares the libraries needed
    by the server and that the <code class="filename">jetty.xml</code> file is used.
    The combined meta data of the <code class="literal">http</code> and
    <code class="literal">server</code> modules results in start.jar generating and
    effective command line that is equivalent to the one at the start of this
    section. </p><p>The startup of this server can be further simplified by using the
    ini-template defined by the modules to create a
    <code class="filename">start.ini</code> file with the command:</p><div class="screenexample"><pre class="screen">&gt; java -jar $JETTY_HOME/start.jar --add-to-start=http
</pre></div><p>Once this is done, the start.ini file may be edited to modify any
    parameters and the server can be run with simple command:</p><div class="screenexample"><pre class="screen">&gt; java -jar $JETTY_HOME/start.jar</pre></div><p>The effective command line generated by the start.jar mechanism can
    be seen using the <code class="literal">--dry-run</code> options:</p><div class="screenexample"><pre class="screen">&gt; java -jar $JETTY_HOME/start.jar --dry-run</pre></div></div></div></div><script type="text/javascript">
      SyntaxHighlighter.all()
    </script><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="administration.html"><i class="icon-chevron-left"></i> Previous</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="administration.html"><i class="icon-chevron-up"></i> Top</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="startup-xml-config.html">Next <i class="icon-chevron-right"></i></a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;III.&nbsp;Jetty Administration Guide&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><i class="icon-home"></i> Home</a></td><td width="40%" align="right" valign="top">&nbsp;Managing XML Based Startup Configuration</td></tr></table></div><p xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times"><div class="jetty-callout">
            See an error or something missing?
            <span class="callout"><a href="http://github.com/jetty-project/jetty-documentation">Contribute to this documentation at
                <span class="website"><i class="icon-github"></i> Github!</span></a></span><span style="float: right"><i>(Generated: 2013-10-04T09:00:43-05:00)</i></span></div></p><script xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" xmlns:xslthl="http://xslthl.sf.net" xmlns:gcse="http://www.google.com" xmlns:date="http://exslt.org/dates-and-times" type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1149868-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script></body></html>