<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors</title><link rel="stylesheet" type="text/css" href="css/docbook.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><meta name="keywords" content="jetty, servlet-api, cometd, http, spdy, eclipse, maven, java, software"><link rel="home" href="index.html" title="Jetty : The Definitive Reference"><link rel="up" href="configuring.html" title="Part&nbsp;II.&nbsp;Jetty Configuration Guide"><link rel="prev" href="configuring.html" title="Part&nbsp;II.&nbsp;Jetty Configuration Guide"><link rel="next" href="configuring-form-size.html" title="Configuring Form Size"><link xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" rel="shortcut icon" href="images/favicon.ico"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><center xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0"><a href="http://www.eclipse.org/jetty"><img src="images/jetty-logo.svg" width="80"></a></center><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="configuring.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;II.&nbsp;Jetty Configuration Guide</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="configuring-form-size.html">Next</a></td></tr></table><hr></div><div xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" style="background-color: #DFF2FD; text-align: left; font-size:80%; font-family: arial, sans; border:thin dotted blue; padding: 4px; "><span style="font-variant: small-caps; font-weight: bold"><a href="http://www.webtide.com/support.jsp" style="text-decoration:none">Contact the core Jetty developers at
          <span style="color:#fd360b"> www.webtide.com</span></a></span><br><span style="font-style:oblique;font-size: 80%">
 private support for your internal/customer projects ... custom extensions and distributions ... versioned snapshots for indefinite support ...
 scalability guidance for your apps and Ajax/Comet projects ... development services from 1 day to full product delivery
    </span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="configuring-connectors"></a>Chapter&nbsp;4.&nbsp;Configuring Jetty Connectors</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="configuring-connectors.html#jetty-connectors">Configuring Connectors</a></span></dt><dt><span class="section"><a href="configuring-form-size.html">Configuring Form Size</a></span></dt><dt><span class="section"><a href="configuring-ssl.html">Configuring SSL</a></span></dt><dt><span class="section"><a href="configuring-virtual-hosts.html">Configuring Virtual Hosts</a></span></dt><dt><span class="section"><a href="setting-port80-access.html">Setting Port 80 Access for a Non-Root User</a></span></dt></dl></div><p></p><p>
    <span class="bold"><strong>THIS CHAPTER HAS NOT YET BEEN UPDATED FOR JETTY-9</strong></span>
  </p><p></p><p>This chapter discusses various options for configuring Jetty connectors.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jetty-connectors"></a>Configuring Connectors</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="configuring-connectors.html#d0e1161">Constructing a ServerConnector</a></span></dt><dt><span class="section"><a href="configuring-connectors.html#d0e1174">Configuring ServerConnector network settings.</a></span></dt><dt><span class="section"><a href="configuring-connectors.html#d0e1250">Configuring Common Services for Connection Factories</a></span></dt><dt><span class="section"><a href="configuring-connectors.html#d0e1255">Configuring Connection Factories</a></span></dt></dl></div><p>Connectors are the mechanism through which Jetty accepts network connections for various protocols. Configuring
  a connector is a combination of configuring the network parameters on the connector itself (eg port), configuring the
  services used by the connector (eg executors &amp; schedulers) and configuration of the connection factories used to
  instantiate and configure the protocol for an accepted connection. Jetty primarily uses a single connector type
  called <a class="link" href="http://download.eclipse.org/jetty/stable-9/apidocs/org/eclipse/jetty/server/ServerConnector.html" target="_top">
  ServerConnector</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Prior to Jetty-9, the type of the connector was used to specify both the protocol and the implementation used
    (eg NIO vs blocking IO). In Jetty-9 the is only an NIO connector and the protocol is now configured by a collection
    of ConnectionFactory on the connector. Thus Jetty-9 primarily uses a single connector type: ServerConnector</p></div><p>The standard jetty distribution comes with the following Jetty IoC XML files that create and configure
  connectors, which should be read in conjunction with this section:</p><div class="variablelist"><dl><dt><span class="term">
        <a class="link" href="http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/plain/jetty-server/src/main/config/etc/jetty-http.xml" target="_top">jetty-http.xml</a>
      </span></dt><dd><p>Instantiates a Server connector with a HTTP connection factory. HTTP connections may be upgraded to
        Websocket.</p></dd><dt><span class="term">
        <a class="link" href="http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/plain/jetty-server/src/main/config/etc/jetty-https.xml" target="_top">jetty-https.xml</a>
      </span></dt><dd><p>Instantiates a Server connector with a TLS connection factory chained to a HTTP connection. This accepts
        TLS connections and are assumed to carry the HTTP protocol.</p></dd><dt><span class="term">
        <a class="link" href="http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/plain/jetty-spdy/spdy-example-webapp/src/main/config/etc/jetty-spdy.xml" target="_top">jetty-spdy.xml</a>
      </span></dt><dd><p>Instantiates a Server connector with a TLS connection factory chained to a NPN (Next Protocol
        Negotiation) connection factory. Once an accepted TLS connection is chained to a NPN connection which replaces
        itself with a connection for a protocol it negotiates with the client, which may be a version of SPDY or HTTP.
        If the client does not support NPN, then HTTP is assumed.</p></dd></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1161"></a>Constructing a ServerConnector</h3></div></div></div><p>The services used by a ServerConnector instance are set by constructor injection and once instantiated cannot
    be changed. Most of the services may be defaulted with null or 0 values so that a reasonable default is used, thus
    for most purposes only the Server and the Connection Factories need to be passed to the connector constructor. In
    Jetty IoC XML this can be done with:</p><div class="informalexample"><pre class="programlisting">
<strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.ServerConnector"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"server"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Ref</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"Server"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"factories"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;Array</strong> <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.ConnectionFactory"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
      <em class="hl-comment" style="color: silver">&lt;!-- insert one or more factories here --&gt;</em>
    <strong class="hl-tag" style="color: #000096">&lt;/Array&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
  <em class="hl-comment" style="color: silver">&lt;!-- set connector fields here --&gt;</em>
<strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
      </pre></div><p>The other arguments that can be passed when constructing a Server Connector may be seen in the <a class="link" href="http://download.eclipse.org/jetty/stable-9/apidocs/org/eclipse/jetty/server/ServerConnector.html#ServerConnector%28org.eclipse.jetty.server.Server,%20java.util.concurrent.Executor,%20org.eclipse.jetty.util.thread.Scheduler,%20org.eclipse.jetty.io.ByteBufferPool,%20int,%20int,%20org.eclipse.jetty.server.ConnectionFactory...%29" target="_top">javadoc</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1174"></a>Configuring ServerConnector network settings.</h3></div></div></div><p>The connector network settings are configured by calling setters on the connector before it is started. For
    example the port can be set with the Jetty IoC XML:</p><div class="informalexample"><pre class="programlisting">
<strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.ServerConnector"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"server"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Ref</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"Server"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"factories"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><em class="hl-comment" style="color: silver">&lt;!-- insert one or more factories here --&gt;</em><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>

  <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"port"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>8080<strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
      </pre></div><p>Values in Jetty IoC can also be parameterized so that they may be passed from property files or set on the
    command line. Thus typically the port is set with Jetty IoC XML that uses the Property element:</p><div class="informalexample"><pre class="programlisting">
<strong class="hl-tag" style="color: #000096">&lt;New</strong> <span class="hl-attribute" style="color: #F5844C">class</span>=<span class="hl-value" style="color: #993300">"org.eclipse.jetty.server.ServerConnector"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"server"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Ref</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">"Server"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;Arg</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"factories"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><em class="hl-comment" style="color: silver">&lt;!-- insert one or more factories here --&gt;</em><strong class="hl-tag" style="color: #000096">&lt;/Arg&gt;</strong>

  <strong class="hl-tag" style="color: #000096">&lt;Set</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"port"</span><strong class="hl-tag" style="color: #000096">&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;Property</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"jetty.port"</span> <span class="hl-attribute" style="color: #F5844C">default</span>=<span class="hl-value" style="color: #993300">"8080"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong><strong class="hl-tag" style="color: #000096">&lt;/Set&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/New&gt;</strong>
      </pre></div><p>The network settings that can be set on the <a class="link" href="http://download.eclipse.org/jetty/stable-9/apidocs/org/eclipse/jetty/server/ServerConnector.html" target="_top">
    ServerConnector</a> include:</p><div class="table"><a name="d0e1192"></a><p class="title"><b>Table&nbsp;4.1.&nbsp;Connector configuration</b></p><div class="table-contents"><table summary="Connector configuration" border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">Field</th><th align="center">Description</th></tr></thead><tbody><tr><td>host</td><td>The network interface this connector binds to as an IP address or a hostname. If null or 0.0.0.0,
            then bind to all interfaces.</td></tr><tr><td>port</td><td>The configured port for the connector or 0 a random available port may be used (selected port
            available via getLocalPort()).</td></tr><tr><td>idleTimeout</td><td>The time in milliseconds that the connection can be idle before it is closed.</td></tr><tr><td>defaultProtocol</td><td>The name of the default protocol used to select a Connection Factory instance.</td></tr><tr><td>stopTimeout</td><td>The time in milliseconds to wait while gently stopping a connector.</td></tr><tr><td>acceptQueueSize</td><td>The size of the pending connection backlog. The exact interpretation is JVM and Operating system
            specific and may be ignored. Higher values allow more connections to be waiting pending and acceptor
            thread.</td></tr><tr><td>reuseAddress</td><td>Allow the server socket to be rebound even if in <a class="link" href="http://www.ssfnet.org/Exchange/tcp/tcpTutorialNotes.html" target="_top">TIME_WAIT</a></td></tr><tr><td>soLingerTime</td><td>A value &gt;=0 set the socket <a class="link" href="http://stackoverflow.com/questions/3757289/tcp-option-so-linger-zero-when-its-required" target="_top">
            SO_LINGER</a> value in milliseconds</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1250"></a>Configuring Common Services for Connection Factories</h3></div></div></div><p>xxx</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1255"></a>Configuring Connection Factories</h3></div></div></div><p>xxx</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configuring.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="configuring.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="configuring-form-size.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;II.&nbsp;Jetty Configuration Guide&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Configuring Form Size</td></tr></table></div><div xmlns:jfetch="java:org.eclipse.jetty.xslt.tools.JavaSourceFetchExtension" xmlns:fetch="java:org.eclipse.jetty.xslt.tools.SourceFetchExtension" xmlns:d="http://docbook.org/ns/docbook" xmlns:l="http://docbook.sourceforge.net/xmlns/l10n/1.0" style="background-color: #DFF2FD; text-align: left; font-size:80%; font-family: arial, sans; border:thin dotted blue; padding: 4px; "><span style="font-style:oblique;font-size: 80%">
See an error or something missing?<br></span><span style="font-variant: small-caps; font-weight: bold"><a href="http://github.com/jetty-project/jetty-documentation" style="text-decoration:none">Contribute to this documentation at 
          <span style="color:#fd360b"> Github!</span></a></span><br></div></body></html>